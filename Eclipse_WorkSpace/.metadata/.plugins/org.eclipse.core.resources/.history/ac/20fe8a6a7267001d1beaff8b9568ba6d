package InstallManager;

import java.io.File;
import java.io.IOException;

import MainSystem.SettingsController;
import messageHandler.MessageHandler;

public class FirstTimeManager {
    public static boolean firstTime = false;
    public static String path;
    public static boolean checkFirstTime() {
        SettingsController.loadSettings();
        path = ProgramController.systemPath + ProgramController.systemSubPath + ProgramController.SystemInstallPath;
        File file = new File(path);
        if(!file.exists()){
            file.mkdirs();
        }
        path = path + ProgramController.SystemConfig;
        file = new File(path);
        String setting = "FirstTime";
		if(file.exists()){
            MessageHandler.handleMessage(1, "FirstTime Configuration Found", false);
            boolean exists = SettingsController.SearchForSet(setting);
            if(exists){
                firstTime = Boolean.parseBoolean(SettingsController.getSetting(setting));
                MessageHandler.handleMessage(1, "FirstTime: " + firstTime, false);
                return firstTime;
            }else{
                MessageHandler.handleMessage(1, "Unable to Find Setting \"FirstTime\" ", true);
                SettingsController.setSetting(setting, "false");
                firstTime = true;
                return firstTime;
            }
        }else{
            try{
                file.createNewFile();
                SettingsController.setSetting(setting, "false");
                firstTime = true;
                return firstTime;
            }catch(IOException e){
                MessageHandler.handleMessage(-2, "Unable to create Configuration File", true);
                MessageHandler.dumpAll();
                System.exit(1);
                return true;
            }
        }
    }

    public static boolean updateFirstTime(){
        SettingsController.loadSettings();
        if(firstTime){
            firstTime=  !firstTime;
        }else if(!firstTime){
            firstTime=true;
        }
        SettingsController.setSetting("FirstTime", String.valueOf(firstTime));

        return firstTime;
    }
}
